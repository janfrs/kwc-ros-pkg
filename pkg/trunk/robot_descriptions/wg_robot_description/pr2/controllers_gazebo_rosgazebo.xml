<?xml version="1.0"?>

<robot name="pr2"><!-- name of the robot-->

<map name="controllers" flag="gazebo"> <!-- we can set a name too, but the convertor only cares about the type -->
  <verbatim key="controllers"> <!-- The key attribute is needed noly if multiple <xml> tags are in the same <data> tag -->

  <!-- ptz camera controls -->
  <controller:generic_ptz name="ptz_cam_left_controller">
    <updateRate>15.0</updateRate> <!-- rate not implemented in gazebo yet-->
    <panJoint>ptz_pan_left_joint</panJoint>
    <tiltJoint>ptz_tilt_left_joint</tiltJoint>
    <interface:ptz name="ptz_left_iface" />
  </controller:generic_ptz>

  <controller:generic_ptz name="ptz_cam_right_controller">
    <updateRate>15.0</updateRate> <!-- rate not implemented in gazebo yet-->
    <panJoint>ptz_pan_right_joint</panJoint>
    <tiltJoint>ptz_tilt_right_joint</tiltJoint>
    <interface:ptz name="ptz_right_iface" />
  </controller:generic_ptz>

  <!-- PR2_ACTARRAY -->
  <controller:pr2_actarray name="pr2_controller" plugin="libPr2_Actarray.so">
      <updateRate>100.0</updateRate>
      <!-- caster array -->
      <joint name="caster_front_left_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>2</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="wheel_front_left_l_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="wheel_front_left_r_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="caster_front_right_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>2</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="wheel_front_right_l_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="wheel_front_right_r_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="caster_rear_left_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>2</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="wheel_rear_left_l_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="wheel_rear_left_r_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="caster_rear_right_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>2</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="wheel_rear_right_l_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <joint name="wheel_rear_right_r_joint">
        <saturationTorque>5</saturationTorque>
        <pGain>0.5</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
      </joint>
      <!-- ========================================= -->
      <!-- torso array -->
      <joint name="torso_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <!-- ========================================= -->
      <!-- left arm array -->
      <joint name="shoulder_pan_left_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="shoulder_pitch_left_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="upperarm_roll_left_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="elbow_flex_left_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="forearm_roll_left_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="wrist_flex_left_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="gripper_roll_left_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <!-- Special gripper joint -->
      <joint name="gripper_left_joint" type="gripper_special">
        <left_proximal>finger_l_left_joint</left_proximal>
        <left_distal>finger_tip_l_left_joint</left_distal>
        <right_proximal>finger_r_left_joint</right_proximal>
        <right_distal>finger_tip_r_left_joint</right_distal>
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <!-- ========================================= -->
      <!-- right arm array -->
      <joint name="shoulder_pan_right_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="shoulder_pitch_right_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="upperarm_roll_right_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="elbow_flex_right_joint">
        <saturationTorque>1000</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="forearm_roll_right_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="wrist_flex_right_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="gripper_roll_right_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <!-- Special gripper joint -->
      <joint name="gripper_right_joint" type="gripper_special">
        <left_proximal>finger_l_right_joint</left_proximal>
        <left_distal>finger_tip_l_right_joint</left_distal>
        <right_proximal>finger_r_right_joint</right_proximal>
        <right_distal>finger_tip_r_right_joint</right_distal>
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <!-- head and above array -->
      <joint name="head_pan_joint">
        <saturationTorque>100</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="head_tilt_joint">
        <saturationTorque>10</saturationTorque>
        <pGain>1</pGain>
        <dGain>0</dGain>
        <iGain>0</iGain>
        <iClamp>0</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <joint name="tilt_laser_joint">
        <saturationTorque>500</saturationTorque>
        <pGain>2</pGain>
        <dGain>0</dGain>
        <iGain>1</iGain>
        <iClamp>20</iClamp>
        <explicitDampingCoefficient>1.0</explicitDampingCoefficient>
        <controlMode>PD_CONTROL</controlMode>
      </joint>
      <!-- ========================================= -->
      <interface:pr2array name="pr2_iface"/>
      <!-- ========================================= -->
  </controller:pr2_actarray>

  <!-- P3D for position groundtruth -->
  <controller:P3D name="p3d_right_wrist_controller" plugin="libP3D.so">
      <updateRate>100.0</updateRate>
      <bodyName>gripper_roll_right</bodyName>
      <interface:position name="p3d_right_wrist_position"/>
  </controller:P3D>

  <controller:P3D name="p3d_left_wrist_controller" plugin="libP3D.so">
      <updateRate>100.0</updateRate>
      <bodyName>gripper_roll_left</bodyName>
      <interface:position name="p3d_left_wrist_position"/>
  </controller:P3D>

  <controller:P3D name="p3d_base_controller" plugin="libP3D.so">
      <updateRate>100.0</updateRate>
      <bodyName>base</bodyName>
      <interface:position name="p3d_base_position"/>
  </controller:P3D>


  </verbatim>
</map>

</robot>

